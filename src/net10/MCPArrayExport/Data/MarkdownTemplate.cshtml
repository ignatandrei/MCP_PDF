@inherits RazorBlade.PlainTextTemplate<MCPArrayExport.Data.ArrayData>
@{

    var nr = Model.JsonArray.Length;
    string header = "| Nr | " + string.Join(" | ", Model.Properties) + " |";
    string separator = "|" + string.Concat(Enumerable.Repeat("---------|", nr + 1));
    string row = "";
    for (int i = 0; i < nr; i++)
    {
        var jsonObject = Model.JsonArray[i];

        row += "| " + (i + 1) + " | " +
                     string.Join(" | ", Model
                         .Properties
                         .Select(it => GetJsonValue(jsonObject.GetProperty(it)).ToString())
                     ) + " | "
                     ;
        row += "\r\n";
    }
}

@header
@separator
@row


Generated by https://github.com/ignatandrei/MCP_PDF

@functions{
    private object? GetJsonValue(JsonElement element)
    {
        var valueKind = element.ValueKind;
        return valueKind switch
        {
            JsonValueKind.String => element.GetString(),
            JsonValueKind.Number => element.GetDouble(),
            JsonValueKind.True => true,
            JsonValueKind.False => false,
            JsonValueKind.Null => null,
            JsonValueKind.Array => "not handled array",
            JsonValueKind.Object => "not handled object",
            _ => "not handled " + valueKind.ToString()
        };
    }
}